<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="UziSport.Controls.CatalogViewPopup"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    InputTransparent="False"
    IsVisible="False">
    <Grid
        BackgroundColor="#80000000"
        HorizontalOptions="Fill"
        VerticalOptions="Fill">

        <!--  Popup ở giữa  -->
        <Frame
            Padding="20"
            BackgroundColor="White"
            CornerRadius="10"
            HasShadow="True"
            HeightRequest="400"
            HorizontalOptions="Center"
            VerticalOptions="Center"
            WidthRequest="400">

            <!--  Chia 3 phần: form nhập / line / list  -->
            <Grid RowDefinitions="Auto,*,Auto">
                <!--  Form nhập + nút  -->
                <VerticalStackLayout Grid.Row="0" Spacing="10">
                    <Label
                        FontAttributes="Bold"
                        FontSize="18"
                        HorizontalOptions="Center"
                        Text="Thêm danh mục" />
                    <Entry
                        x:Name="CatalogNameEntry"
                        Completed="CatalogNameEntry_Completed"
                        Placeholder="Tên danh mục" />
                    <Label
                        x:Name="CatalogExistsLabel"
                        FontSize="18"
                        HorizontalOptions="Center"
                        IsVisible="False"
                        Text="Danh mục này đã tồn tại!"
                        TextColor="Red" />
                    <!--  Line ngăn cách  -->
                    <BoxView
                        BackgroundColor="#DDDDDD"
                        HeightRequest="1"
                        HorizontalOptions="Fill" />
                </VerticalStackLayout>
                <!--  Danh sách danh mục hiện có  -->
                <CollectionView
                    Grid.Row="1"
                    Margin="0,8,0,0"
                    ItemsSource="{Binding Catalogs}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <!--  Mỗi record: Tên danh mục + nút X  -->
                            <Grid ColumnDefinitions="*,Auto" RowSpacing="2">
                                <HorizontalStackLayout
                                    Grid.Column="0"
                                    Margin="0,3,0,3"
                                    HeightRequest="35"
                                    VerticalOptions="Center">

                                    <Entry
                                        Grid.Column="0"
                                        Margin="2,0,0,0"
                                        HorizontalTextAlignment="Start"
                                        Text="{Binding CatalogName}"
                                        VerticalTextAlignment="Center" />

                                    <!--  Nút Xóa  -->
                                    <Button
                                        Grid.Column="1"
                                        Margin="6,0,0,0"
                                        BackgroundColor="Transparent"
                                        Clicked="DeleteCatalogButton_Clicked"
                                        FontSize="16"
                                        Text="✕"
                                        TextColor="Red"
                                        WidthRequest="40" />
                                </HorizontalStackLayout>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <VerticalStackLayout Grid.Row="2">
                    <!--  Line ngăn cách  -->
                    <BoxView
                        BackgroundColor="#DDDDDD"
                        HeightRequest="1"
                        HorizontalOptions="Fill" />
                    <HorizontalStackLayout
                        Margin="10"
                        HorizontalOptions="Center"
                        Spacing="40">
                        <Button
                            BackgroundColor="DarkGreen"
                            Clicked="SaveButton_Clicked"
                            Text="Lưu"
                            WidthRequest="90" />
                        <Button
                            BackgroundColor="DarkRed"
                            Clicked="CancelButton_Clicked"
                            Text="Hủy"
                            WidthRequest="90" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Grid>
        </Frame>
    </Grid>
</ContentView>
